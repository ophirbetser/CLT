---
title: "Central Limit Theorem"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    social: menu  
    source_code: embed
runtime: shiny
---



# משפט הגבול המרכזי

```{r global, include=FALSE}
# load data in 'global' chunk so it can be shared by all users of the dashboard
pacman::p_load(data.table, tidyverse, colourpicker,
               shiny, flexdashboard, openxlsx, glue,
               stringi)

ch <- function(a){
  as.character(a)
}

ch(123)

```




Column {.sidebar}
-----------------------------------------------------------------------

```{r}

selectInput('dist',  label = 'מרחב הדגימה', c("norm", "uni", "exp"),
                selected= 'norm')


selectInput("m", label = "מספר דגימות שמוגרלות:",
            seq(10, 4000, 5),
            selected= '500')


selectInput("n", label = "מספר התצפיות שמורגלות בכל דגימה",
            seq(10, 20000, 10),
            selected= '100')

renderUI({
selectInput("select_m", "מבט על דגימה תוצאות הגרלה מספר:", seq(1, as.integer(input$m), 1),
            selected= '1')
        })

sliderInput("mean", label = "בחר (אם רלוונטי) ממוצע",
            min = 0.1, max = 20,
            value = c(4))

sliderInput("sd", label = "בחר (אם רלוונטי) סטיית תקן",
            min = 0.1, max = 20,
            value = c(1))

```

```{r}
norm_data <- 
  reactive({
matrix(rnorm( as.integer(input$n)* as.integer(input$m), mean = input$mean, sd = input$sd),  as.integer(input$n),       as.integer(input$m)) %>% as.data.frame()
  })

uni_data <- 
  reactive({
  as.data.table(matrix(runif(as.integer(input$n)* as.integer(input$m), min = 0, max = 1), as.integer(input$n),       as.integer(input$m)))
  })

exp_data <- 
  reactive({
  as.data.table(matrix(rexp(as.integer(input$n)* as.integer(input$m)), as.integer(input$n),       as.integer(input$m)))
  })


```


Column
-----------------------------------------------------------------------

### התפלגות דגימה:

```{r}

renderPlot({
    if(input$dist == 'norm'){
  norm_data() %>% 
    ggplot() +
    geom_histogram(aes_string(x = paste0("V", input$select_m), y = '..density..'),
                   fill = '#71C0ED') +
      labs(
        title = glue('sample {input$select_m} of tot {input$m} samples of {input$dist} dist length {input$n}'),
        subtitle = "",
        y = "",
        x = "",
        caption = "",
        color = "",
        fill = "",
        size = ""
        ) +
    theme_classic()
    } else if(input$dist == 'uni'){
        uni_data() %>% 
    ggplot() +
    geom_histogram(aes_string(x = paste0("V", input$select_m), y = '..density..'),
                   fill = '#62C0ED') +
    labs(
        title = glue('sample {input$select_m} of tot {input$m} samples of {input$dist} dist length {input$n}'),
        subtitle = "",
        y = "",
        x = "",
        caption = "",
        color = "",
        fill = "",
        size = ""
        ) +
    theme_classic()
    } else {
    exp_data() %>% 
    ggplot() +
    geom_histogram(aes_string(x = paste0("V", input$select_m), y = '..density..'),
                   fill = '#62C0ED') +
    labs(
        title = glue('sample {input$select_m} of tot {input$m} samples of {input$dist} dist length {input$n}'),
        subtitle = "",
        y = "",
        x = "",
        caption = "",
        color = "",
        fill = "",
        size = ""
        ) +
    theme_classic()

      
    }
})
```


### התפלגות הממוצעים:
    
```{r}
renderPlot({
  if(input$dist == 'norm'){
  as.data.table(x = map_dbl(norm_data(), mean)) %>% 
    ggplot() +
    geom_histogram(aes_string(x = paste0("V1"), y = '..density..'),
                   fill = '#194BA8') +
    theme_classic()
  } else {
    as.data.table(x = map_dbl(uni_data(), mean)) %>% 
    ggplot() +
    geom_histogram(aes_string(x = paste0("V1"), y = '..density..'),
                   fill = '#194BA8') +
    theme_classic()
  }
})
```

# טבלת הנתונים

### כל עמודה מייצגת הגרלה של וקטור רנדומלי מתוך מרחב התפלגות

```{r}
renderTable({
  if(input$dist == 'norm'){
  norm_data()
} else {
  uni_data()
}
})

```

